/*! Native Promise Only
    v0.8.0-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(a,b,c){b[a]=b[a]||c(),"undefined"!=typeof module&&module.exports?module.exports=b[a]:"function"==typeof define&&define.amd&&define(function(){return b[a]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function g(a,d){c.add(a,d),b||(b=e(c.drain))}function h(a){var b,c=typeof a;return null==a||"object"!=c&&"function"!=c||(b=a.then),"function"==typeof b?b:!1}function i(){for(var a=0;a<this.chain.length;a++)j(this,1===this.state?this.chain[a].success:this.chain[a].failure,this.chain[a]);this.chain.length=0}function j(a,b,c){var d,e;try{b===!1?c.reject(a.msg):(d=b===!0?a.msg:b.call(void 0,a.msg),d===c.promise?c.reject(TypeError("Promise-chain cycle")):(e=h(d))?e.call(d,c.resolve,c.reject):c.resolve(d))}catch(f){c.reject(f)}}function k(a){var b,c=this;if(!c.triggered){c.triggered=!0,c.def&&(c=c.def);try{(b=h(a))?g(function(){var d=new n(c);try{b.call(a,function(){k.apply(d,arguments)},function(){l.apply(d,arguments)})}catch(e){l.call(d,e)}}):(c.msg=a,c.state=1,c.chain.length>0&&g(i,c))}catch(d){l.call(new n(c),d)}}}function l(a){var b=this;b.triggered||(b.triggered=!0,b.def&&(b=b.def),b.msg=a,b.state=2,b.chain.length>0&&g(i,b))}function m(a,b,c,d){for(var e=0;e<b.length;e++)!function(e){a.resolve(b[e]).then(function(a){c(e,a)},d)}(e)}function n(a){this.def=a,this.triggered=!1}function o(a){this.promise=a,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function p(a){if("function"!=typeof a)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var b=new o(this);this.then=function(a,c){var d={success:"function"==typeof a?a:!0,failure:"function"==typeof c?c:!1};return d.promise=new this.constructor(function(a,b){if("function"!=typeof a||"function"!=typeof b)throw TypeError("Not a function");d.resolve=a,d.reject=b}),b.chain.push(d),0!==b.state&&g(i,b),d.promise},this["catch"]=function(a){return this.then(void 0,a)};try{a.call(void 0,function(a){k.call(b,a)},function(a){l.call(b,a)})}catch(c){l.call(b,c)}}var a,b,c,d=Object.prototype.toString,e="undefined"!=typeof setImmediate?function(a){return setImmediate(a)}:setTimeout;try{Object.defineProperty({},"x",{}),a=function(a,b,c,d){return Object.defineProperty(a,b,{value:c,writable:!0,configurable:d!==!1})}}catch(f){a=function(a,b,c){return a[b]=c,a}}c=function(){function e(a,b){this.fn=a,this.self=b,this.next=void 0}var a,c,d;return{add:function(b,f){d=new e(b,f),c?c.next=d:a=d,c=d,d=void 0},drain:function(){var d=a;for(a=c=b=void 0;d;)d.fn.call(d.self),d=d.next}}}();var q=a({},"constructor",p,!1);return p.prototype=q,a(q,"__NPO__",0,!1),a(p,"resolve",function(a){var b=this;return a&&"object"==typeof a&&1===a.__NPO__?a:new b(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");b(a)})}),a(p,"reject",function(a){return new this(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");c(a)})}),a(p,"all",function(a){var b=this;return"[object Array]"!=d.call(a)?b.reject(TypeError("Not an array")):0===a.length?b.resolve([]):new b(function(c,d){if("function"!=typeof c||"function"!=typeof d)throw TypeError("Not a function");var e=a.length,f=Array(e),g=0;m(b,a,function(a,b){f[a]=b,++g===e&&c(f)},d)})}),a(p,"race",function(a){var b=this;return"[object Array]"!=d.call(a)?b.reject(TypeError("Not an array")):new b(function(c,d){if("function"!=typeof c||"function"!=typeof d)throw TypeError("Not a function");m(b,a,function(a,b){c(b)},d)})}),p});